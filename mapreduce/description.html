<html>
  
  <head>
    <link rel="stylesheet" type="text/css" href="preview.css">
  </head>
  
  <body>
    <!--<%def name="title()">MapReduce</%def>-->
    <div class="sectiontitle" id="previewtitle"><h2>MapReduce</h2></div>
    <div class="saas_tile" id="tile">
      <div class="saas_avatar saas_in">
        <img src="Images/200x128.png">
      </div>
      <div class="saas_content">
        <p class="saas_name saas_in">MapReduce</p>
        <div class="saas_controls">
          <button class="meh">
            <span class="js-icon text-success">+</span>
            <span class="saas_msg" data-state_msg="Available" data-action_msg="Install">Available</span>
          </button>
        </div>
        <div class="saas_description saas_in" id="tiledescription">MapReduce is a programming model and an associated implementation for processing and generating large data sets with a parallel, distributed algorithm on a cluster.</div>
      </div>
    </div>
    
    <div class="integration_content" id="int-overview">
      <h2>Overview</h2>
      <p>Capture MapReduce metrics to:</p>
      <ul>
        <li>Analyze and inspect individual MapReduce jobs and tasks.</li>
        <li>Visualize performance of individual tasks.</li>
      </ul>
      <p>
        <img class="screenshot" src="Images/snapshot.png" />
      </p>
    </div>
    
    <div class="integration_content"  id="int-configuration">
      <h2>Configuration</h2>
      <p>
        <em>Install Datadog Agent on the Master Node where the ResourceManager is running</em>
      </p>
      
      <ol>
        <li>Configure the agent to connect to the ResourceManager<br>
        Edit ${confd_help('<code>conf.d/%s.yaml</code>' % agent_name)}
        <pre class="textfile">
          <code>
instances:
  #
  # The MapReduce check retrieves metrics from YARN's ResourceManager. This
  # check must be run from the Master Node and the ResourceManager URI must
  # be specified below. The ResourceManager URI is composed of the 
  # ResourceManager's hostname and port.
  #
  # The ResourceManager hostname can be found in the yarn-site.xml conf file
  # under the property yarn.resourcemanager.address
  #
  # The ResourceManager port can be found in the yarn-site.xml conf file under
  # the property yarn.resourcemanager.webapp.address
  #
  - resourcemanager_uri: http://localhost:8088

init_config:
  #
  # Optional metrics can be specified for counters. For more information on
  # counters visit the MapReduce documentation page:
  # https://hadoop.apache.org/docs/current/hadoop-mapreduce-client/hadoop-mapreduce-client-core/MapredAppMasterRest.html#Job_Counters_API
  #

  general_counters:
    #
    # general_counters are job agnostic metrics that create a metric for each
    # specified counter
    #
    - counter_group_name: 'org.apache.hadoop.mapreduce.TaskCounter'
      counters:
        - counter_name: 'MAP_INPUT_RECORDS'
        - counter_name: 'MAP_OUTPUT_RECORDS'
        - counter_name: 'REDUCE_INPUT_RECORDS'
        - counter_name: 'REDUCE_OUTPUT_RECORDS'
    #
    # Additional counter's can be specified as following
    #

    # - counter_group_name: 'org.apache.hadoop.mapreduce.FileSystemCounter'
    #   counters:
    #     - counter_name: 'HDFS_BYTES_READ'

  job_specific_counters:
    #
    # job_specific_counters are metrics that are specific to a particular job.
    # The following example specifies counters for the jobs 'Foo' and 'Bar'.
    #

    # - job_name: 'Foo'
    #   metrics:
    #     - counter_group_name: 'org.apache.hadoop.mapreduce.FileSystemCounter'
    #       counters:
    #         - counter_name: 'FILE_BYTES_WRITTEN'
    #         - counter_name: 'HDFS_BYTES_WRITTEN'
    #     - counter_group_name: 'org.apache.hadoop.mapreduce.FileSystemCounter'
    #       counters:
    #         - counter_name: 'HDFS_BYTES_READ'
    # - job_name: 'Bar'
    #   metrics:
    #     - counter_group_name: 'org.apache.hadoop.mapreduce.FileSystemCounter'
    #       counters:
    #         - counter_name: 'FILE_BYTES_WRITTEN'
          </code>
        </pre>
        </li>

        <li>Restart the Agent</li>

        <li>Execute the info command and verify that the integration check passed. The output of the command should contain a section similar to the following:
        <pre class="verification">
          <code>
  Checks
  ======

    [...]

    mapreduce
    ---------
      - instance #0 [OK]
      - Collected 120 metrics, 0 events & 8 service checks
  
          </code>
        </pre>

        </li>
      </ol>
    </div>
</body>
</html>